# 更新日志

## [1.3.1] - 2025-11-28

### 🐛 修复问题
- 修复主题设置无法持久化的问题
- 优化主题初始化流程，消除启动时的闪烁
- 增强 ThemePlugin 的健壮性和错误处理

### 🔧 技术改进
- 为 ThemePlugin 添加单元测试
- 优化插件初始化超时处理
- 完善日志系统

## [1.3.0] - 2024-11-18

### 🎉 新增功能
- ✨ **超高清视频支持** - 完整支持4K/8K视频格式播放
- ✨ **智能硬件加速** - 自动检测并启用硬件解码（VideoToolbox/DXVA2/VAAPI/MediaCodec）
- ✨ **性能监控面板** - 实时显示CPU、GPU、内存占用，帧率和丢帧统计
- ✨ **视频信息面板** - 详细显示编解码器、分辨率、码率、帧率等技术参数
- ✨ **播放质量设置** - 自动/高质量/低功耗/兼容模式智能切换
- ✨ **右键上下文菜单** - 快速访问视频信息、性能监控、截图等功能
- ✨ **智能性能覆盖层** - F8键或右键菜单切换，实时性能指标显示
- ✨ **自适应缓冲优化** - 针对超高清视频优化的缓冲策略

### 🚀 技术架构
- 创建 `HardwareAccelerationService` - 硬件加速检测和管理
- 创建 `PerformanceMonitorService` - 实时性能监控和统计
- 创建 `VideoAnalyzerService` - 视频文件分析和格式检测
- 创建 `CodecInfoService` - 编解码器信息管理
- 新增视频技术信息模型：`VideoInfo`、`CodecInfo`、`HardwareAccelerationConfig`
- 创建性能监控组件：`PerformanceOverlay`、`VideoInfoPanel`

### 🎨 用户界面增强
- **性能信息对话框** - 详细播放性能信息展示，带颜色编码指标
- **视频信息面板** - 美观的技术参数展示，支持滚动
- **性能覆盖层** - 半透明实时性能指标，不遮挡视频
- **智能颜色系统** - 根据性能好坏自动变色（绿/橙/红）
- **右键菜单** - 丰富的上下文菜单选项
- **格式支持页面** - 详细的格式兼容性说明

### 📹 格式支持扩展
- **容器格式**: MP4、MKV、AVI、MOV、WebM、FLV、WMV
- **视频编码**: H.264/AVC、HEVC/H.265、VP9、AV1、MPEG-2/4
- **音频编码**: AAC、MP3、AC3/DTS、FLAC、Opus、Vorbis
- **分辨率**: 720p、1080p、1440p、2160p(4K)、4320p(8K)
- **HDR支持**: HDR10、HLG，部分Dolby Vision支持
- **硬件加速**: 全平台硬件解码支持

### ⚙️ 播放设置
- **播放质量模式**: 自动/高质量/低功耗/兼容模式
- **硬件加速控制**: 启用/禁用，状态显示
- **缓冲策略设置**: 自动缓冲、自定义大小、预加载选项

### 📈 性能优化
- **硬件解码**: CPU占用降低50-70%
- **智能缓冲**: 10GB+大文件加载时间<3秒
- **快速seek**: 大文件精确跳转<500ms
- **内存管理**: 自动缓存清理，防止内存泄漏
- **自适应缓冲**: 根据视频分辨率和码率调整

### 🧪 质量保证
- **单元测试**: 新增硬件加速、性能监控、视频分析服务测试
- **集成测试**: 超高清播放完整流程测试
- **跨平台测试**: 各平台硬件加速兼容性验证
- **性能测试**: 4K/8K视频播放性能基准测试

### 🐛 修复问题
- 修复性能信息对话框文字显示不清问题
- 修复对话框内容溢出问题
- 改进性能指标颜色系统，更加直观美观
- 优化右键菜单交互体验

### 📝 规格更新
- 完成 `support-uhd-video-formats` 提案
- 详细的超高清视频支持规格文档
- 硬件加速和性能监控完整技术规范
- 跨平台兼容性测试报告

## [1.2.0] - 2024-11-17

### 🎉 新增功能
- ✨ **播放历史搜索** - 按视频名称快速搜索历史记录
- ✨ **智能过滤** - 按观看状态、时间范围筛选历史
- ✨ **批量操作** - 多选和批量删除历史记录
- ✨ **缩略图支持** - 视频预览缩略图显示和缓存管理
- ✨ **自定义设置** - 个性化历史记录管理选项
- ✨ **播放统计** - 详细的观看数据和统计信息

### 🔧 技术改进
- 添加 `path_provider` 和 `path` 依赖用于文件管理
- 创建 `SettingsService` 统一管理应用设置
- 创建 `ThumbnailService` 管理缩略图缓存
- 增强数据模型，支持更多字段和功能
- 优化搜索性能，支持防抖搜索
- 改进 UI 交互，支持多选模式

### 🎨 用户体验优化
- 新增搜索组件，支持实时搜索和搜索建议
- 新增过滤组件，支持多种筛选条件
- 优化历史记录列表，支持缩略图显示
- 新增设置界面，提供丰富的配置选项
- 改进空状态提示，提供更好的用户引导
- 优化批量操作流程，提供确认反馈

### 📈 性能优化
- 实现搜索结果防抖，减少不必要的搜索
- 优化缩略图缓存管理，控制存储空间
- 改进列表渲染性能，支持大量数据
- 添加异步加载，避免界面卡顿

### 🐛 修复问题
- 修复设置界面 SwitchListTile 参数错误
- 优化缩略图服务的文件处理逻辑
- 改进错误处理和用户反馈

### 📝 规格更新
- 更新 `playback-history` 规格，包含所有增强功能
- 新增设置管理和缩略图服务规格
- 完善用户场景和交互流程

## [1.1.0] - 2024-11-17

### 🎉 新增功能
- ✨ **播放历史记录功能** - 自动记录观看进度，支持断点续播
- 📱 **主界面标签页** - 分离媒体库和播放历史界面
- 💾 **本地存储** - 使用 SharedPreferences 本地保存历史记录
- ⏱️ **自动保存** - 每5秒自动保存播放进度
- 🔍 **智能搜索** - 检测已删除文件并提供清理选项
- 📊 **播放统计** - 在设置中显示观看时长和完成情况

### 🔧 技术改进
- 添加 shared_preferences 依赖用于本地存储
- 添加 intl 依赖用于时间格式化
- 创建 PlaybackHistory 数据模型
- 创建 HistoryService 服务层
- 创建 HistoryListWidget UI 组件
- 重构主界面为标签页布局
- 增强播放器界面支持历史记录集成

### 🎨 用户体验优化
- 智能断点续播提示
- 历史记录支持继续观看或重新开始
- 文件不存在时友好提示
- 进度条可视化显示观看进度
- 一键清空历史记录功能

### 📈 性能优化
- 历史记录数量限制（最多50条）
- 自动清理过期记录（30天）
- 异步加载避免界面卡顿

### 🐛 修复问题
- 修复跨平台文件路径处理
- 优化 Web 平台视频 URL 处理

### 📝 规格更新
- 新增 `playback-history` 规格定义
- 完善用户场景和需求描述
- 更新项目文档和使用说明

## [1.0.0] - 2024-11-16

### 🎉 初始发布
- ✅ 跨平台视频播放支持（iOS、Android、Web、Windows、macOS、Linux）
- ✅ 基础播放控制（播放/暂停、进度调节、音量控制）
- ✅ 全屏播放模式
- ✅ 响应式 Material Design 3 界面
- ✅ 自动隐藏控制栏（3秒后自动隐藏）
- ✅ 智能文件选择（适配Web和桌面平台）
- ✅ 多格式视频支持

---

## 更新说明

### 版本号规则
- **主版本号**: 不兼容的API修改
- **次版本号**: 向下兼容的功能性新增
- **修订号**: 向下兼容的问题修正

### 功能图标说明
- 🎉 新功能
- 🔧 技术改进
- 🎨 界面优化
- 📈 性能优化
- 🐛 问题修复
- 📝 文档更新
- ⚠️ 重要变更
- 🗑️ 废弃功能